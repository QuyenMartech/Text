#!/bin/bash
# ================================================================
# Script: 3proxy IPv6 + Cloudflare WARP Protection
# M·ª•c ƒë√≠ch: T·∫°o proxy IPv6 HO·∫†T ƒê·ªòNG + che ch·∫Øn VPS b·∫±ng WARP
# ================================================================

if [ "$(id -u)" != "0" ]; then
    echo "‚ùå This script must be run as root"
    exit 1
fi

# M√†u s·∫Øc ƒë·ªÉ d·ªÖ ƒë·ªçc
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

echo -e "${GREEN}============================================${NC}"
echo -e "${GREEN}  3proxy IPv6 + WARP Protection${NC}"
echo -e "${GREEN}============================================${NC}"

echo -e "\n${YELLOW}‚ö†Ô∏è  Script n√†y s·∫Ω:${NC}"
echo -e "${YELLOW}1. T·∫°o h√†ng lo·∫°t proxy IPv6 (gi·ªëng script g·ªëc)${NC}"
echo -e "${YELLOW}2. C√†i ƒë·∫∑t Cloudflare WARP ƒë·ªÉ che ch·∫Øn VPS${NC}"
echo -e "${YELLOW}3. K·∫øt n·ªëi: Client ‚Üí 3proxy ‚Üí WARP ‚Üí Internet${NC}"
echo -e "\n${BLUE}Nh·∫•n Enter ƒë·ªÉ ti·∫øp t·ª•c...${NC}"
read

# ================================================================
# PH·∫¶N 1: C√ÄI ƒê·∫∂T G√ìI (G·ªêC + WARP)
# ================================================================

echo -e "\n${YELLOW}[B∆∞·ªõc 1/9] C√†i ƒë·∫∑t g√≥i c·∫ßn thi·∫øt...${NC}"
if [ -f /etc/redhat-release ]; then
    yum -y install gcc net-tools bsdtar zip curl expect >/dev/null 2>&1
    echo -e "${GREEN}‚úÖ ƒê√£ c√†i g√≥i cho CentOS/RHEL${NC}"
else
    apt-get update -qq
    apt-get install -y gcc net-tools bsdtar zip curl expect >/dev/null 2>&1
    echo -e "${GREEN}‚úÖ ƒê√£ c√†i g√≥i cho Ubuntu/Debian${NC}"
fi

# ================================================================
# PH·∫¶N 2: C√ÄI ƒê·∫∂T CLOUDFLARE WARP
# ================================================================

install_cloudflare_warp() {
    echo -e "\n${YELLOW}[B∆∞·ªõc 2/9] C√†i ƒë·∫∑t Cloudflare WARP...${NC}"
    
    if [ -f /etc/redhat-release ]; then
        curl -fsSL https://pkg.cloudflareclient.com/cloudflare-warp-ascii.repo | tee /etc/yum.repos.d/cloudflare-warp.repo >/dev/null
        yum install -y cloudflare-warp >/dev/null 2>&1
    else
        curl -fsSL https://pkg.cloudflareclient.com/pubkey.gpg | gpg --dearmor -o /usr/share/keyrings/cloudflare-warp-archive-keyring.gpg 2>/dev/null
        echo "deb [arch=amd64 signed-by=/usr/share/keyrings/cloudflare-warp-archive-keyring.gpg] https://pkg.cloudflareclient.com/ $(lsb_release -cs) main" | tee /etc/apt/sources.list.d/cloudflare-client.list >/dev/null
        apt-get update -qq
        apt-get install -y cloudflare-warp >/dev/null 2>&1
    fi
    
    echo -e "${GREEN}‚úÖ WARP ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t${NC}"
}

configure_cloudflare_warp() {
    echo -e "\n${YELLOW}[B∆∞·ªõc 3/9] C·∫•u h√¨nh WARP...${NC}"
    
    # Kh·ªüi ƒë·ªông d·ªãch v·ª• WARP
    systemctl enable warp-svc >/dev/null 2>&1
    systemctl restart warp-svc
    sleep 3
    echo -e "${BLUE}  ‚Üí WARP service ƒë√£ kh·ªüi ƒë·ªông${NC}"
    
    # X√≥a ƒëƒÉng k√Ω c≈© (n·∫øu c√≥)
    warp-cli disconnect >/dev/null 2>&1
    warp-cli registration delete >/dev/null 2>&1
    sleep 2
    
    # ƒêƒÉng k√Ω WARP m·ªõi
    echo -e "${BLUE}  ‚Üí ƒêang ƒëƒÉng k√Ω WARP...${NC}"
    echo -e "y\ny\ny" | warp-cli registration new >/dev/null 2>&1
    sleep 3
    
    # ƒê·∫∑t ch·∫ø ƒë·ªô PROXY (quan tr·ªçng!)
    warp-cli mode proxy >/dev/null 2>&1
    sleep 2
    echo -e "${BLUE}  ‚Üí ƒê√£ ƒë·∫∑t ch·∫ø ƒë·ªô proxy${NC}"
    
    # K·∫øt n·ªëi WARP ƒë·ªÉ m·ªü port 40000
    echo -e "${BLUE}  ‚Üí ƒêang k·∫øt n·ªëi WARP...${NC}"
    warp-cli connect >/dev/null 2>&1
    sleep 8
    
    # Ki·ªÉm tra WARP c√≥ ho·∫°t ƒë·ªông kh√¥ng
    for i in {1..10}; do
        if netstat -tuln 2>/dev/null | grep -q ":40000" || ss -tuln 2>/dev/null | grep -q ":40000"; then
            WARP_IP=$(curl -x socks5://127.0.0.1:40000 -s --connect-timeout 10 https://api.ipify.org 2>/dev/null)
            echo -e "${GREEN}‚úÖ WARP ho·∫°t ƒë·ªông! IP qua WARP: ${WARP_IP}${NC}"
            return 0
        fi
        echo -e "${YELLOW}  ‚è≥ ƒê·ª£i WARP proxy... ($i/10)${NC}"
        sleep 3
    done
    
    echo -e "${RED}‚ùå WARP ch∆∞a ho·∫°t ƒë·ªông, nh∆∞ng script s·∫Ω ti·∫øp t·ª•c${NC}"
}

# ================================================================
# PH·∫¶N 3: H√ÄM T·ª™ SCRIPT G·ªêC (GI·ªÆ NGUY√äN 100%)
# ================================================================

random() {
    tr </dev/urandom -dc A-Za-z0-9 | head -c8
    echo
}

array=(1 2 3 4 5 6 7 8 9 0 a b c d e f)
gen64() {
    ip64() {
        echo "${array[$RANDOM % 16]}${array[$RANDOM % 16]}${array[$RANDOM % 16]}${array[$RANDOM % 16]}"
    }
    echo "$1:$(ip64):$(ip64):$(ip64):$(ip64)"
}

install_3proxy() {
    echo -e "\n${YELLOW}[B∆∞·ªõc 4/9] C√†i ƒë·∫∑t 3proxy...${NC}"
    URL="https://raw.githubusercontent.com/quayvlog/quayvlog/main/3proxy-3proxy-0.8.6.tar.gz"
    wget -qO- $URL | bsdtar -xvf- >/dev/null 2>&1
    cd 3proxy-3proxy-0.8.6
    make -f Makefile.Linux >/dev/null 2>&1
    mkdir -p /usr/local/etc/3proxy/{bin,logs,stat}
    cp src/3proxy /usr/local/etc/3proxy/bin/
    cd $WORKDIR
    echo -e "${GREEN}‚úÖ 3proxy ƒë√£ ƒë∆∞·ª£c bi√™n d·ªãch v√† c√†i ƒë·∫∑t${NC}"
}

gen_3proxy() {
    cat <<EOF
daemon
maxconn 2000
nscache 65535
timeouts 1 5 30 60 180 1800 15 60
setgid 65535
setuid 65535
flush

# ===== TH√äM WARP L√ÄM L·ªöP B·∫¢O V·ªÜ =====
# N·∫øu mu·ªën d√πng WARP, b·ªè comment d√≤ng d∆∞·ªõi:
# parent 1000 socks5 127.0.0.1 40000

auth strong

users $(awk -F "/" 'BEGIN{ORS="";} {print $1 ":CL:" $2 " "}' ${WORKDATA})

$(awk -F "/" '{print "auth strong\nallow " $1 "\nproxy -6 -n -a -p" $4 " -i" $3 " -e"$5 "\n"}' ${WORKDATA})
EOF
}

gen_proxy_file_for_user() {
    cat >proxy.txt <<EOF
$(awk -F "/" '{print $3 ":" $4 ":" $1 ":" $2 }' ${WORKDATA})
EOF
}

print_proxy() {
    echo -e "\n${GREEN}============================================${NC}"
    echo -e "${GREEN}  ‚úÖ PROXY S·∫¥N S√ÄNG!${NC}"
    echo -e "${GREEN}============================================${NC}"
    echo -e "${BLUE}Format: IP:PORT:USER:PASS${NC}"
    echo -e "${YELLOW}File: ${WORKDIR}/proxy.txt${NC}\n"
    cat proxy.txt | head -10
    TOTAL=$(wc -l < proxy.txt)
    if [ $TOTAL -gt 10 ]; then
        echo -e "\n${BLUE}... v√† $((TOTAL - 10)) proxy kh√°c${NC}"
    fi
}

gen_data() {
    seq $FIRST_PORT $LAST_PORT | while read port; do
        echo "usr$(random)/pass$(random)/$IP4/$port/$(gen64 $IP6)"
    done
}

gen_iptables() {
    cat <<EOF
$(awk -F "/" '{print "iptables -I INPUT -p tcp --dport " $4 " -m state --state NEW -j ACCEPT"}' ${WORKDATA})
EOF
}

gen_ifconfig() {
    cat <<EOF
$(awk -F "/" '{print "ip -6 addr add " $5 "/64 dev enp1s0"}' ${WORKDATA})
EOF
}

# ================================================================
# PH·∫¶N 4: T·∫†O SYSTEMD SERVICE CHO WARP
# ================================================================

create_warp_service() {
    echo -e "\n${YELLOW}[B∆∞·ªõc 7/9] T·∫°o service t·ª± ƒë·ªông kh·ªüi ƒë·ªông...${NC}"
    
    cat >/etc/systemd/system/cloudflare-warp-proxy.service <<EOF
[Unit]
Description=Cloudflare WARP Proxy Mode
Before=3proxy.service
After=network.target warp-svc.service
Requires=warp-svc.service

[Service]
Type=oneshot
ExecStart=/usr/bin/warp-cli mode proxy
ExecStartPost=/bin/sleep 3
ExecStartPost=/usr/bin/warp-cli connect
RemainAfterExit=yes
Restart=on-failure
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

    systemctl daemon-reload
    systemctl enable warp-svc >/dev/null 2>&1
    systemctl enable cloudflare-warp-proxy.service >/dev/null 2>&1
    echo -e "${GREEN}‚úÖ Service ƒë√£ ƒë∆∞·ª£c t·∫°o${NC}"
}

# ================================================================
# MAIN SCRIPT - CH·∫†Y THEO TH·ª® T·ª∞
# ================================================================

# C√†i WARP tr∆∞·ªõc
install_cloudflare_warp
configure_cloudflare_warp

# C√†i 3proxy (gi·ªëng script g·ªëc)
echo -e "\n${YELLOW}[B∆∞·ªõc 5/9] Thi·∫øt l·∫≠p 3proxy...${NC}"
WORKDIR="/home/proxy-installer"
WORKDATA="${WORKDIR}/data.txt"
mkdir -p $WORKDIR && cd $_

install_3proxy

IP4=$(curl -4 -s icanhazip.com)
IP6=$(curl -6 -s icanhazip.com | cut -f1-4 -d':')

echo -e "${BLUE}VPS c·ªßa b·∫°n:${NC}"
echo -e "  IPv4: ${GREEN}${IP4}${NC}"
echo -e "  IPv6: ${GREEN}${IP6}${NC}"

echo -e "\n${YELLOW}B·∫°n mu·ªën t·∫°o bao nhi√™u proxy? (V√≠ d·ª•: 200)${NC}"
read COUNT

FIRST_PORT=10000
LAST_PORT=$(($FIRST_PORT + $COUNT - 1))

echo -e "\n${YELLOW}[B∆∞·ªõc 6/9] T·∫°o c·∫•u h√¨nh proxy...${NC}"
gen_data >$WORKDIR/data.txt
gen_iptables >$WORKDIR/boot_iptables.sh
gen_ifconfig >$WORKDIR/boot_ifconfig.sh
chmod +x ${WORKDIR}/boot_*.sh
echo -e "${GREEN}‚úÖ ƒê√£ t·∫°o $COUNT proxy t·ª´ port $FIRST_PORT ƒë·∫øn $LAST_PORT${NC}"

# T·∫°o file c·∫•u h√¨nh 3proxy
gen_3proxy >/usr/local/etc/3proxy/3proxy.cfg

# TƒÉng gi·ªõi h·∫°n file m·ªü
echo "* soft nofile 65535" >> /etc/security/limits.conf
echo "* hard nofile 65535" >> /etc/security/limits.conf
if [ -f /etc/pam.d/common-session ]; then
    echo "session required pam_limits.so" >> /etc/pam.d/common-session
fi

# T·∫°o systemd service cho 3proxy
cat >/etc/systemd/system/3proxy.service <<EOF
[Unit]
Description=3proxy tiny proxy server
After=network.target cloudflare-warp-proxy.service
Wants=cloudflare-warp-proxy.service

[Service]
Type=forking
ExecStart=/usr/local/etc/3proxy/bin/3proxy /usr/local/etc/3proxy/3proxy.cfg
ExecStop=/bin/kill -TERM \$MAINPID
RemainAfterExit=yes
Restart=always
LimitNOFILE=65535

[Install]
WantedBy=multi-user.target
EOF

systemctl daemon-reload
systemctl enable 3proxy >/dev/null 2>&1

create_warp_service

# ================================================================
# PH·∫¶N QUAN TR·ªåNG: KH·ªûI ƒê·ªòNG ƒê√öNG TH·ª® T·ª∞
# ================================================================

echo -e "\n${YELLOW}[B∆∞·ªõc 8/9] Kh·ªüi ƒë·ªông d·ªãch v·ª•...${NC}"

# 1. Kh·ªüi ƒë·ªông WARP tr∆∞·ªõc
systemctl start cloudflare-warp-proxy.service
sleep 3

# 2. C·∫•u h√¨nh iptables (m·ªü port)
echo -e "${BLUE}  ‚Üí C·∫•u h√¨nh firewall...${NC}"
bash ${WORKDIR}/boot_iptables.sh 2>/dev/null

# 3. T·∫†O ƒê·ªäA CH·ªà IPv6 (QUAN TR·ªåNG NH·∫§T!)
echo -e "${BLUE}  ‚Üí T·∫°o ƒë·ªãa ch·ªâ IPv6 tr√™n interface...${NC}"
bash ${WORKDIR}/boot_ifconfig.sh 2>/dev/null
sleep 2
echo -e "${GREEN}‚úÖ ƒê√£ t·∫°o $COUNT ƒë·ªãa ch·ªâ IPv6${NC}"

# 4. C·∫•u h√¨nh firewalld (n·∫øu c√≥)
if command -v firewall-cmd >/dev/null 2>&1; then
    echo -e "${BLUE}  ‚Üí C·∫•u h√¨nh firewalld...${NC}"
    for port in $(seq $FIRST_PORT $LAST_PORT); do
        firewall-cmd --permanent --add-port=${port}/tcp >/dev/null 2>&1
    done
    firewall-cmd --reload >/dev/null 2>&1
fi

# 5. T·∫°o file proxy cho user
gen_proxy_file_for_user

# 6. Kh·ªüi ƒë·ªông 3proxy
echo -e "${BLUE}  ‚Üí Kh·ªüi ƒë·ªông 3proxy...${NC}"
systemctl start 3proxy
sleep 3

# Hi·ªÉn th·ªã k·∫øt qu·∫£
print_proxy

# ================================================================
# PH·∫¶N 9: KI·ªÇM TRA V√Ä H∆Ø·ªöNG D·∫™N
# ================================================================

echo -e "\n${YELLOW}============================================${NC}"
echo -e "${YELLOW}  [B∆∞·ªõc 9/9] KI·ªÇM TRA H·ªÜ TH·ªêNG${NC}"
echo -e "${YELLOW}============================================${NC}"

# Ki·ªÉm tra IPv6
echo -e "${BLUE}Ki·ªÉm tra ƒë·ªãa ch·ªâ IPv6...${NC}"
IPV6_COUNT=$(ip -6 addr show enp1s0 | grep -c "inet6 ${IP6}:")
if [ "$IPV6_COUNT" -gt 0 ]; then
    echo -e "${GREEN}‚úÖ ƒê√£ t·∫°o $IPV6_COUNT ƒë·ªãa ch·ªâ IPv6 tr√™n enp1s0${NC}"
else
    echo -e "${RED}‚ùå Ch∆∞a c√≥ ƒë·ªãa ch·ªâ IPv6! Proxy s·∫Ω kh√¥ng ho·∫°t ƒë·ªông${NC}"
fi

# Ki·ªÉm tra WARP
echo -e "\n${BLUE}Ki·ªÉm tra WARP...${NC}"
if netstat -tuln 2>/dev/null | grep -q ":40000" || ss -tuln 2>/dev/null | grep -q ":40000"; then
    WARP_TEST=$(curl -x socks5://127.0.0.1:40000 -s --connect-timeout 10 https://api.ipify.org 2>/dev/null)
    if [ -n "$WARP_TEST" ]; then
        echo -e "${GREEN}‚úÖ WARP ho·∫°t ƒë·ªông! IP: $WARP_TEST${NC}"
        WARP_OK=true
    else
        echo -e "${YELLOW}‚ö†Ô∏è  Port 40000 m·ªü nh∆∞ng kh√¥ng k·∫øt n·ªëi ƒë∆∞·ª£c${NC}"
        WARP_OK=false
    fi
else
    echo -e "${YELLOW}‚ö†Ô∏è  WARP ch∆∞a m·ªü port 40000${NC}"
    WARP_OK=false
fi

# Ki·ªÉm tra 3proxy
echo -e "\n${BLUE}Ki·ªÉm tra 3proxy...${NC}"
if systemctl is-active --quiet 3proxy; then
    echo -e "${GREEN}‚úÖ 3proxy ƒëang ch·∫°y${NC}"
    
    # Ki·ªÉm tra port
    OPEN_PORTS=$(ss -tuln | grep -c ":100[0-9][0-9] ")
    echo -e "${GREEN}‚úÖ C√≥ $OPEN_PORTS port ƒëang l·∫Øng nghe${NC}"
else
    echo -e "${RED}‚ùå 3proxy KH√îNG ch·∫°y!${NC}"
fi

# Test proxy th·ª±c t·∫ø
echo -e "\n${BLUE}Test proxy th·ª±c t·∫ø...${NC}"
TEST_PROXY=$(head -1 proxy.txt)
if [ -n "$TEST_PROXY" ]; then
    echo -e "${YELLOW}Proxy test: ${TEST_PROXY}${NC}"
    
    # Test 3 l·∫ßn
    for i in {1..3}; do
        TEST_IP=$(timeout 15 curl -x "http://${TEST_PROXY}" -s https://api.ipify.org 2>/dev/null)
        
        if [ -n "$TEST_IP" ]; then
            echo -e "${GREEN}‚úÖ L·∫ßn $i: K·∫øt n·ªëi th√†nh c√¥ng! IP = ${TEST_IP}${NC}"
            
            # Ki·ªÉm tra xem c√≥ ƒëi qua WARP kh√¥ng
            if [ "$TEST_IP" != "$IP4" ] && [ "$WARP_OK" = true ]; then
                echo -e "${GREEN}   üéâ IP kh√°c VPS ‚Üí ƒêang qua WARP!${NC}"
            elif [ "$TEST_IP" = "$IP4" ]; then
                echo -e "${YELLOW}   ‚ö†Ô∏è  IP = VPS ‚Üí Ch∆∞a qua WARP${NC}"
            fi
            break
        else
            if [ $i -lt 3 ]; then
                echo -e "${YELLOW}‚è≥ L·∫ßn $i timeout, th·ª≠ l·∫°i...${NC}"
                sleep 3
            else
                echo -e "${YELLOW}‚ö†Ô∏è  Timeout sau 3 l·∫ßn (c√≥ th·ªÉ do m·∫°ng ch·∫≠m)${NC}"
            fi
        fi
    done
fi

# ================================================================
# K·∫æT QU·∫¢ CU·ªêI C√ôNG
# ================================================================

echo -e "\n${GREEN}============================================${NC}"
echo -e "${GREEN}  üìä K·∫æT QU·∫¢ C√ÄI ƒê·∫∂T${NC}"
echo -e "${GREEN}============================================${NC}"

if [ "$IPV6_COUNT" -gt 0 ] && systemctl is-active --quiet 3proxy; then
    echo -e "${GREEN}‚úÖ C√ÄI ƒê·∫∂T TH√ÄNH C√îNG!${NC}"
    echo -e "${GREEN}   ‚îú‚îÄ T·∫°o ƒë∆∞·ª£c ${COUNT} proxy IPv6${NC}"
    echo -e "${GREEN}   ‚îú‚îÄ 3proxy ƒëang ch·∫°y${NC}"
    
    if [ "$WARP_OK" = true ]; then
        echo -e "${GREEN}   ‚îî‚îÄ WARP ho·∫°t ƒë·ªông ‚Üí C√≥ l·ªõp b·∫£o v·ªá${NC}"
    else
        echo -e "${YELLOW}   ‚îî‚îÄ WARP ch∆∞a ho·∫°t ƒë·ªông ‚Üí Ch∆∞a c√≥ l·ªõp b·∫£o v·ªá${NC}"
    fi
    
    echo -e "\n${BLUE}üìÅ File proxy: ${WORKDIR}/proxy.txt${NC}"
else
    echo -e "${RED}‚ùå C√ì L·ªñI X·∫¢Y RA!${NC}"
    echo -e "${RED}   Ki·ªÉm tra log: journalctl -u 3proxy -n 50${NC}"
fi

# L∆∞u h∆∞·ªõng d·∫´n
cat > ${WORKDIR}/HUONG-DAN.txt <<EOF
================================================
  H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG
================================================

1. FILE PROXY:
   ${WORKDIR}/proxy.txt
   S·ªë l∆∞·ª£ng: ${COUNT} proxy
   Port: ${FIRST_PORT} - ${LAST_PORT}
   Format: IP:PORT:USER:PASS

2. C·∫§U TR√öC H·ªÜ TH·ªêNG:
   - KH√îNG d√πng WARP: Client ‚Üí 3proxy (IPv6) ‚Üí Internet
   - C√ì d√πng WARP: Client ‚Üí 3proxy ‚Üí WARP ‚Üí Internet

3. B·∫¨T WARP CHO T·∫§T C·∫¢ PROXY:
   S·ª≠a file: /usr/local/etc/3proxy/3proxy.cfg
   B·ªè comment d√≤ng: parent 1000 socks5 127.0.0.1 40000
   (X√≥a d·∫•u # ·ªü ƒë·∫ßu d√≤ng)
   
   Sau ƒë√≥: systemctl restart 3proxy

4. KI·ªÇM TRA WARP HO·∫†T ƒê·ªòNG:
   netstat -tuln | grep 40000
   curl -x socks5://127.0.0.1:40000 https://api.ipify.org

5. TEST PROXY:
   curl -x http://IP:PORT:USER:PASS https://api.ipify.org

6. KH·∫ÆC PH·ª§C S·ª∞ C·ªê:
   - 3proxy kh√¥ng start:
     journalctl -u 3proxy -n 50
     
   - WARP kh√¥ng ho·∫°t ƒë·ªông:
     systemctl restart warp-svc
     warp-cli mode proxy
     warp-cli connect
     sleep 10
     systemctl restart 3proxy
     
   - Proxy timeout:
     Ki·ªÉm tra IPv6: ip -6 addr show enp1s0
     Ki·ªÉm tra port: ss -tuln | grep 100

7. LOG FILES:
   - 3proxy: /usr/local/etc/3proxy/logs/3proxy.log
   - WARP: journalctl -u warp-svc
   - System: journalctl -u 3proxy

================================================
EOF

echo -e "\n${YELLOW}üìñ H∆∞·ªõng d·∫´n chi ti·∫øt: ${WORKDIR}/HUONG-DAN.txt${NC}"

# Hi·ªÉn th·ªã l·ªánh h·ªØu √≠ch
echo -e "\n${BLUE}üí° L·ªÜNH H·ªÆU √çCH:${NC}"
echo -e "${BLUE}  ‚Ä¢ Xem log 3proxy:     journalctl -u 3proxy -f${NC}"
echo -e "${BLUE}  ‚Ä¢ Kh·ªüi ƒë·ªông l·∫°i:      systemctl restart 3proxy${NC}"
echo -e "${BLUE}  ‚Ä¢ Ki·ªÉm tra WARP:      warp-cli status${NC}"
echo -e "${BLUE}  ‚Ä¢ Test proxy:         curl -x http://$(head -1 proxy.txt) https://api.ipify.org${NC}"

echo -e "\n${GREEN}‚úÖ HO√ÄN T·∫§T!${NC}"
